# Арифметический сдвиг вправо двоичного числа
# Формат ввода: X # Y (двоичные числа без знака)
# Формат вывода: результат сдвига
# Алфавит: 0 1 # _ (пробел)

# Состояния
States: q0 q1 q2 q3 q4 q5 q6 q7 q8 q9 q10 q_accept q_reject

# Начальное состояние
Start: q0

# Принимающее состояние
Accept: q_accept

# Отвергающее состояние
Reject: q_reject

# Алфавит (символ _ означает пробел/пустота)
Alphabet: 0 1 # _

# Переходы (формат: состояние_символ -> состояние_символ_движение)

# ===== БЛОК 1: Поиск разделителя # =====
# Идем вправо, ищем #
q0 0 -> q0 0 R
q0 1 -> q0 1 R
q0 # -> q1 _ R  # Заменяем # на _ (будет разделителем)
q0 _ -> q0 _ R
q0   -> q0   R

# ===== БЛОК 2: Дойти до конца Y =====
# После замены # на _ идем до конца Y
q1 0 -> q1 0 R
q1 1 -> q1 1 R
q1 _ -> q1 _ R
q1   -> q2   L  # Дошли до конца Y, начинаем уменьшать

# ===== БЛОК 3: Уменьшение Y на 1 (двоичное вычитание) =====
# Y находится между _ и пробелом, вычитаем 1
q2 0 -> q2 1 L   # 0 -> 1 при заёме
q2 1 -> q3 0 L   # 1 -> 0, останов заёма
q2 _ -> q6 _ R   # Если сразу _, значит Y=0, переход к сборке
q2   -> q2   L

# Возвращаемся к разделителю _
q3 0 -> q3 0 L
q3 1 -> q3 1 L
q3 _ -> q4 _ L   # Дошли до разделителя, идем к X
q3   -> q3   L

# ===== БЛОК 4: Поиск последней цифры X для удаления =====
# Идем влево по X, ищем последнюю 0 или 1
q4 0 -> q5 _ R   # Нашли 0, заменяем на _ и идем обратно
q4 1 -> q5 _ R   # Нашли 1, заменяем на _ и идем обратно
q4 _ -> q4 _ L   # Пропускаем уже удаленные разряды
q4   -> q1   R   # X пуст, идем к началу цикла

# ===== БЛОК 5: Возврат к началу Y для следующей итерации =====
# После удаления цифры идем обратно к Y
q5 _ -> q5 _ R
q5 0 -> q1 0 R   # Не должно встречаться, но на всякий случай
q5 1 -> q1 1 R
q5   -> q1   R

# ===== БЛОК 6: Проверка, что Y=0 и начало сборки результата =====
# Y=0 (все биты Y между _ и пробелом стали 0)
q6 _ -> q6 _ R
q6 0 -> q2 0 L   # Нашли ненулевой бит Y, продолжаем цикл
q6 1 -> q2 1 L   # Нашли ненулевой бит Y, продолжаем цикл
q6   -> q7   L   # Y полностью обработан, начинаем сборку

# ===== БЛОК 7: Замена всех _ в X на 0 (нули слева) =====
# Идем влево, заменяем _ на 0
q7 0 -> q7 0 L
q7 1 -> q7 1 L
q7 _ -> q7 0 L   # Заменяем _ на 0
q7   -> q8   R   # Дошли до начала, теперь сдвигаем

# ===== БЛОК 8: Сдвиг оставшихся цифр вправо =====
# Переносим все 0 и 1 вправо, заполняя нулями слева
q8 0 -> q8 0 R
q8 1 -> q8 1 R
q8 _ -> q9 _ L   # Дошли до конца X
q8   -> q9   L

# ===== БЛОК 9: Очистка лишних символов справа =====
# Заменяем все после X на пробелы
q9 0 -> q10 0 L
q9 1 -> q10 1 L
q9 _ -> q9   L   # Стираем _
q9   -> q_accept   R  # Готово

# ===== БЛОК 10: Возврат к началу результата =====
# Возвращаемся к началу результата
q10 0 -> q10 0 L
q10 1 -> q10 1 L
q10 _ -> q10 _ L
q10   -> q8   R  # Возвращаемся к началу для продолжения
